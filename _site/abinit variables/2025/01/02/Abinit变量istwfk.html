<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Abinit变量istwfk | ZWei</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Abinit变量istwfk" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="在ABINIT软件中，istwfk 是一个用于控制每个k点波函数存储方式的参数。它决定了是否利用时间反演对称性来优化波函数在倒空间中的存储，从而减少计算所需的平面波数量。" />
<meta property="og:description" content="在ABINIT软件中，istwfk 是一个用于控制每个k点波函数存储方式的参数。它决定了是否利用时间反演对称性来优化波函数在倒空间中的存储，从而减少计算所需的平面波数量。" />
<link rel="canonical" href="http://localhost:4000/abinit%20variables/2025/01/02/Abinit%E5%8F%98%E9%87%8Fistwfk.html" />
<meta property="og:url" content="http://localhost:4000/abinit%20variables/2025/01/02/Abinit%E5%8F%98%E9%87%8Fistwfk.html" />
<meta property="og:site_name" content="ZWei" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-01-02T00:00:00+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Abinit变量istwfk" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-01-02T00:00:00+01:00","datePublished":"2025-01-02T00:00:00+01:00","description":"在ABINIT软件中，istwfk 是一个用于控制每个k点波函数存储方式的参数。它决定了是否利用时间反演对称性来优化波函数在倒空间中的存储，从而减少计算所需的平面波数量。","headline":"Abinit变量istwfk","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/abinit%20variables/2025/01/02/Abinit%E5%8F%98%E9%87%8Fistwfk.html"},"url":"http://localhost:4000/abinit%20variables/2025/01/02/Abinit%E5%8F%98%E9%87%8Fistwfk.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="ZWei" /><link rel="stylesheet" href="/assets/css/copy-button.css">
  
   <!-- 添加 MathJax 支持，之前网页上数学公式不显示，现这段代码后能够正常显示。 -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        displayMath: [['$$','$$'], ['\\[','\\]']],
        processEscapes: true
      },
      TeX: {
        extensions: ["AMSmath.js", "AMSsymbols.js"]
      }
    });
  </script>
   <!-- MathJax.js本来是个网页，我下载到了本地，然后修改了路径，现在可以正常显示了。 -->
  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
</head><body><!-- 网站头部区域 -->
<header class="site-header">
  <!-- wrapper类用于控制内容宽度和居中 -->
  <div class="wrapper">
    <!-- 网站标题，点击可返回首页 -->
    <a class="site-title" rel="author" href="/">ZWei</a>

    <!-- 导航菜单区域 -->
    <nav class="site-nav">
      <!-- 汉堡菜单按钮 -->
      <input type="checkbox" id="nav-trigger" class="nav-trigger" />
      <label for="nav-trigger">
        <span class="menu-icon">
          <svg viewBox="0 0 18 15" width="18px" height="15px">
            <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
          </svg>
        </span>
      </label>

      <div class="trigger">
        <!-- 获取所有页面路径 --><!-- 遍历所有页面 --><!-- 获取当前页面信息 --><!-- 如果页面有标题，则显示在导航栏中 --><!-- 获取当前页面信息 --><!-- 如果页面有标题，则显示在导航栏中 --><a class="page-link" href="/about/">简介</a><!-- 获取当前页面信息 --><!-- 如果页面有标题，则显示在导航栏中 --><a class="page-link" href="/blog/">博客</a><!-- 获取当前页面信息 --><!-- 如果页面有标题，则显示在导航栏中 --><!-- 获取当前页面信息 --><!-- 如果页面有标题，则显示在导航栏中 --><!-- 获取当前页面信息 --><!-- 如果页面有标题，则显示在导航栏中 --><a class="page-link" href="/nav/">导航</a><!-- 获取当前页面信息 --><!-- 如果页面有标题，则显示在导航栏中 --><a class="page-link" href="/projects/">项目</a><!-- 获取当前页面信息 --><!-- 如果页面有标题，则显示在导航栏中 --></div>
    </nav>
  </div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Abinit变量istwfk</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2025-01-02T00:00:00+01:00" itemprop="datePublished">Jan 2, 2025
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>在ABINIT软件中，<code class="language-plaintext highlighter-rouge">istwfk</code> 是一个用于控制每个k点波函数存储方式的参数。它决定了是否利用时间反演对称性来优化波函数在倒空间中的存储，从而减少计算所需的平面波数量。</p>

<hr />

<h3 id="istwfk-的详细说明"><code class="language-plaintext highlighter-rouge">istwfk</code> 的详细说明</h3>

<ol>
  <li><strong>参数类型</strong>：
    <ul>
      <li><strong>变量类型</strong>：整数（integer）</li>
      <li><strong>维度</strong>：<code class="language-plaintext highlighter-rouge">(nkpt)</code>，其中 <code class="language-plaintext highlighter-rouge">nkpt</code> 是k点的数量。</li>
    </ul>
  </li>
  <li><strong>默认值</strong>：
    <ul>
      <li><strong>默认值</strong>：0</li>
      <li><strong>特殊情况</strong>：
        <ul>
          <li>对于响应函数（RF）计算，<code class="language-plaintext highlighter-rouge">istwfk</code> 会被强制设置为1，适用于所有k点。</li>
          <li>对于自旋轨道耦合计算（<code class="language-plaintext highlighter-rouge">nspinor = 2</code>），<code class="language-plaintext highlighter-rouge">istwfk</code> 也会被强制设置为1，适用于所有k点。</li>
        </ul>
      </li>
    </ul>
  </li>
  <li><strong>作用</strong>：
    <ul>
      <li>控制每个k点的波函数在倒空间中的存储方式。</li>
      <li>对于基态（GS）计算，波函数系数存储在 <code class="language-plaintext highlighter-rouge">cg</code> 数组中，每个k点和每个能带对应一个段 <code class="language-plaintext highlighter-rouge">cg(1:2, 1:npw)</code>，其中 <code class="language-plaintext highlighter-rouge">npw</code> 是平面波的数量。</li>
      <li>如果k点坐标仅由0和1/2组成（例如 <code class="language-plaintext highlighter-rouge">(0, 0, 0)</code>、<code class="language-plaintext highlighter-rouge">(½, 0, 0)</code> 等），可以利用时间反演对称性来减少需要显式处理的平面波数量，从而使用实数到复数的FFT（见 <code class="language-plaintext highlighter-rouge">fftalg</code>）。</li>
    </ul>
  </li>
  <li><strong>选项说明</strong>：
    <ul>
      <li><strong><code class="language-plaintext highlighter-rouge">istwfk = 1</code></strong>：<strong>不使用</strong>时间反演对称性。</li>
      <li><strong><code class="language-plaintext highlighter-rouge">istwfk = 2</code></strong>：对 <code class="language-plaintext highlighter-rouge">k = (0, 0, 0)</code> 使用时间反演对称性。</li>
      <li><strong><code class="language-plaintext highlighter-rouge">istwfk = 3</code></strong>：对 <code class="language-plaintext highlighter-rouge">k = (½, 0, 0)</code> 使用时间反演对称性。</li>
      <li><strong><code class="language-plaintext highlighter-rouge">istwfk = 4</code></strong>：对 <code class="language-plaintext highlighter-rouge">k = (0, 0, ½)</code> 使用时间反演对称性。</li>
      <li><strong><code class="language-plaintext highlighter-rouge">istwfk = 5</code></strong>：对 <code class="language-plaintext highlighter-rouge">k = (½, 0, ½)</code> 使用时间反演对称性。</li>
      <li><strong><code class="language-plaintext highlighter-rouge">istwfk = 6</code></strong>：对 <code class="language-plaintext highlighter-rouge">k = (0, ½, 0)</code> 使用时间反演对称性。</li>
      <li><strong><code class="language-plaintext highlighter-rouge">istwfk = 7</code></strong>：对 <code class="language-plaintext highlighter-rouge">k = (½, ½, 0)</code> 使用时间反演对称性。</li>
      <li><strong><code class="language-plaintext highlighter-rouge">istwfk = 8</code></strong>：对 <code class="language-plaintext highlighter-rouge">k = (0, ½, ½)</code> 使用时间反演对称性。</li>
      <li><strong><code class="language-plaintext highlighter-rouge">istwfk = 9</code></strong>：对 <code class="language-plaintext highlighter-rouge">k = (½, ½, ½)</code> 使用时间反演对称性。</li>
      <li><strong><code class="language-plaintext highlighter-rouge">istwfk = 0</code></strong>：<strong>自动选择</strong>。对于每个k点，如果允许使用时间反演对称性，则自动选择适当的选项；否则，设置为 <code class="language-plaintext highlighter-rouge">istwfk = 1</code>。</li>
    </ul>
  </li>
  <li><strong>响应函数（RF）计算的限制</strong>：
    <ul>
      <li>对于RF计算，除了 <code class="language-plaintext highlighter-rouge">cg</code> 数组外，还有 <code class="language-plaintext highlighter-rouge">cgq</code> 和 <code class="language-plaintext highlighter-rouge">cg1</code> 数组。</li>
      <li>要利用时间反演对称性减少这些数组的平面波数量，q向量必须为 <code class="language-plaintext highlighter-rouge">(0, 0, 0)</code>。</li>
      <li>目前，时间反演对称性<strong>不能</strong>用于RF计算。</li>
    </ul>
  </li>
</ol>

<hr />

<h3 id="示例">示例</h3>

<p>假设你有一个k点列表，其中包含 <code class="language-plaintext highlighter-rouge">(0, 0, 0)</code> 和 <code class="language-plaintext highlighter-rouge">(½, 0, 0)</code>，你可以在输入文件中设置：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>istwfk 2 3
</code></pre></div></div>

<p>这表示：</p>
<ul>
  <li>对 <code class="language-plaintext highlighter-rouge">k = (0, 0, 0)</code> 使用时间反演对称性（<code class="language-plaintext highlighter-rouge">istwfk = 2</code>）。</li>
  <li>对 <code class="language-plaintext highlighter-rouge">k = (½, 0, 0)</code> 使用时间反演对称性（<code class="language-plaintext highlighter-rouge">istwfk = 3</code>）。</li>
</ul>

<p>如果希望ABINIT自动选择，可以设置为：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>istwfk 0
</code></pre></div></div>
<hr />

<h3 id="问什么是响应函数计算什么是时间反演对称性">问：什么是响应函数计算？什么是时间反演对称性？</h3>

<hr />
<h3 id="1-响应函数计算response-function-calculation">1. <strong>响应函数计算（Response Function Calculation）</strong></h3>

<p>响应函数计算是研究材料对外部微扰（如电场、磁场或声子扰动）的线性响应的理论方法。它在密度泛函理论（DFT）框架下用于计算材料的电子、光学和晶格动力学性质。</p>

<h4 id="核心概念"><strong>核心概念</strong>：</h4>
<ul>
  <li><strong>微扰理论</strong>：假设外部微扰足够小，系统的响应可以通过线性近似来描述。</li>
  <li><strong>响应函数</strong>：描述系统对外部微扰的响应，例如：
    <ul>
      <li><strong>介电函数</strong>：材料对电场的响应。</li>
      <li><strong>磁化率</strong>：材料对磁场的响应。</li>
      <li><strong>声子谱</strong>：晶格对原子位移的响应。</li>
    </ul>
  </li>
</ul>

<h4 id="应用"><strong>应用</strong>：</h4>
<ul>
  <li><strong>光学性质</strong>：计算材料的吸收光谱、折射率等。</li>
  <li><strong>晶格动力学</strong>：计算声子谱和声子态密度。</li>
  <li><strong>电子激发</strong>：研究电子-电子相互作用和激发态性质。</li>
</ul>

<h4 id="abinit中的响应函数计算"><strong>ABINIT中的响应函数计算</strong>：</h4>
<ul>
  <li>在ABINIT中，响应函数计算通过特定的输入参数和数据集实现。</li>
  <li>涉及的关键变量包括 <code class="language-plaintext highlighter-rouge">irdwfk</code>、<code class="language-plaintext highlighter-rouge">getwfk</code> 和 <code class="language-plaintext highlighter-rouge">istwfk</code>。</li>
  <li>响应函数计算通常需要更多的计算资源和存储空间，因为需要处理额外的波函数和矩阵元。</li>
</ul>

<hr />

<h3 id="2-时间反演对称性time-reversal-symmetry">2. <strong>时间反演对称性（Time-Reversal Symmetry）</strong></h3>

<p>时间反演对称性是物理学中的一种对称性，描述系统在时间反演操作下的行为。时间反演操作是将时间 $t$ 替换为 $-t$。</p>

<h4 id="核心概念-1"><strong>核心概念</strong>：</h4>
<ul>
  <li><strong>时间反演操作</strong>：将系统的运动方向反转，例如将粒子的速度反向。</li>
  <li><strong>时间反演对称性</strong>：如果系统在时间反演操作下保持不变，则称其具有时间反演对称性。</li>
  <li>
    <p><strong>数学表示</strong>：在量子力学中，时间反演算符 $\mathcal{T}$ 作用于波函数 $\psi(\mathbf{r}, t)$ 时，满足：</p>

\[\mathcal{T} \psi(\mathbf{r}, t) = \psi^*(\mathbf{r}, -t)\]

    <p>其中 $\psi^*$ 是波函数的复共轭。</p>
  </li>
</ul>

<h4 id="在固体物理中的应用"><strong>在固体物理中的应用</strong>：</h4>
<ul>
  <li><strong>k空间对称性</strong>：在倒空间中，时间反演对称性将波矢 $\mathbf{k}$ 映射为 $-\mathbf{k}$。</li>
  <li><strong>平面波减少</strong>：对于某些k点（如 $\mathbf{k} = (0, 0, 0)$ 或 $\mathbf{k} = (\frac{1}{2}, 0, 0)$），可以利用时间反演对称性将平面波数量减半，从而减少计算量。</li>
  <li><strong>自旋轨道耦合</strong>：在自旋轨道耦合系统中，时间反演对称性可能导致能级简并（Kramers简并）。</li>
</ul>

<h4 id="在abinit中的应用"><strong>在ABINIT中的应用</strong>：</h4>
<ul>
  <li><strong><code class="language-plaintext highlighter-rouge">istwfk</code> 参数</strong>：控制是否利用时间反演对称性来优化波函数的存储和计算。</li>
  <li><strong>限制</strong>：
    <ul>
      <li>对于响应函数计算，时间反演对称性通常不能使用（<code class="language-plaintext highlighter-rouge">istwfk</code> 被强制设置为1）。</li>
      <li>对于自旋轨道耦合计算，时间反演对称性也不能使用（<code class="language-plaintext highlighter-rouge">istwfk</code> 被强制设置为1）。</li>
    </ul>
  </li>
</ul>


  </div><a class="u-url" href="/abinit%20variables/2025/01/02/Abinit%E5%8F%98%E9%87%8Fistwfk.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">
    <!-- <h2 class="footer-heading">ZWei</h2> -->

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <!-- <li class="p-name">ZWei</li> -->
          <li class="p-name">联系：</li><li><a class="u-email" href="mailto:zhwei@gmx.de">zhwei@gmx.de</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li>
      <a href="https://github.com/weizhengqing">
        <svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg>
      </a>
    </li><li>
      <a href="https://orcid.org/0009-0007-3493-1400">
        <svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#orcid"></use></svg>
      </a>
    </li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>专注于计算科学、材料科学与物理学的学术博客，分享前沿研究见解与专业知识。</p>
      </div>
    </div>
  </div>
  <script src="/assets/js/copy-button.js"></script>
</footer>
</body>

</html>
